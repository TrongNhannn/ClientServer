{"ast":null,"code":"import _toConsumableArray from\"C:/Users/trongnhan/OneDrive/M\\xE1y t\\xEDnh/ClientServer/APP/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/trongnhan/OneDrive/M\\xE1y t\\xEDnh/ClientServer/APP/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import UserCard from'../../users/userselectcard';import ReadOnlyUserCard from'../../users/usercard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default(function(props){var submit=props.submit,setDialog=props.setDialog,partners_=props.partners_,users_=props.users_,project_master=props.project_master;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),sus=_useState2[0],setSus=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),admins=_useState4[0],setAdmins=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useSelector=useSelector(function(state){return state;}),unique_string=_useSelector.unique_string,proxy=_useSelector.proxy;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loaded=_useState8[0],setLoaded=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedUsers=_useState10[0],setSelectedUsers=_useState10[1];useEffect(function(){fetch(\"\".concat(proxy,\"/api/\").concat(unique_string,\"/user/getall\")).then(function(res){return res.json();}).then(function(resp){var data=resp.data,success=resp.success;if(data!=undefined&&data.length>0){var _sus=data.filter(function(user){return user.account_role===\"su\";});var _admins=data.filter(function(user){return user.account_role===\"admin\"&&userNotIn(user,partners_)&&user.credential_string!=project_master;});var _users=data.filter(function(user){return user.account_role===\"user\"&&userNotIn(user,users_)&&user.credential_string!=project_master;});setSus(_sus);setAdmins(_admins);setUsers(_users);setTimeout(function(){setLoaded(true);},500);}});},[]);var userNotIn=function userNotIn(user,dataSet){var queue=dataSet.filter(function(u){return u.credential_string===user.credential_string;});if(queue.length>0){return false;}else{return true;}};var addToQueue=function addToQueue(user){setSelectedUsers([].concat(_toConsumableArray(selectedUsers),[user]));};var removeFromQueue=function removeFromQueue(user){var queue=selectedUsers.filter(function(u){return u.credential_string!=user.credential_string;});setSelectedUsers(queue);};var clickTrigger=function clickTrigger(user){var userExisted=selectedUsers.indexOf(user);if(userExisted!=-1){removeFromQueue(user);}else{addToQueue(user);}};var closeDialog=function closeDialog(){if(selectedUsers.length>0){submit(selectedUsers);}setDialog();};return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed-default z-index-11 fullscreen p-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rel z-index-2 container bg-white h-fit column\",children:!loaded?/*#__PURE__*/_jsx(\"div\",{className:\"w-100-pct h-fit flex flex-middle\",children:/*#__PURE__*/_jsx(\"img\",{className:\"circle-processing\",src:\"/assets/image/circle-processing.png\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"column w-100-pct h-fit p-0-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex w-100-pct scroll-x horizon-scroll-bar border-1-dashed\",style:{height:\"150px\"},children:selectedUsers.length>0?selectedUsers.map(function(user){return/*#__PURE__*/_jsx(UserCard,{user:user,clickTrigger:clickTrigger,width:325});}):/*#__PURE__*/_jsx(\"span\",{className:\"block w-100-pct text-center p-2\",children:\"Nh\\u1EEFng ng\\u01B0\\u1EDDi \\u0111\\u01B0\\u1EE3c ch\\u1ECDn s\\u1EBD xu\\u1EA5t hi\\u1EC7n \\u1EDF \\u0111\\xE2y\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"users-box flex flex-no-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-50-pct p-1 h-fit\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"column h-fit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"block shadow-blur p-1\",children:/*#__PURE__*/_jsx(\"input\",{placeholder:\"Qu\\u1EA3n tr\\u1ECB vi\\xEAn\",spellCheck:\"false\",className:\"no-border block w-100-pct\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"h-fit scroll-y p-1\",children:admins.map(function(user){return/*#__PURE__*/_jsx(UserCard,{user:user,clickTrigger:clickTrigger});})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-50-pct p-1 h-fit\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"column h-fit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"block shadow-blur p-1\",children:/*#__PURE__*/_jsx(\"input\",{placeholder:\"Ng\\u01B0\\u1EDDi d\\xF9ng\",spellCheck:\"false\",className:\"no-border block w-100-pct\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"h-fit scroll-y p-1\",children:users.map(function(user){return/*#__PURE__*/_jsx(UserCard,{user:user,clickTrigger:clickTrigger});})})]})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"abs-default z-index-1 fullscreen trans-dark\",onClick:closeDialog})]});});","map":{"version":3,"names":["useState","useEffect","useDispatch","useSelector","UserCard","ReadOnlyUserCard","props","submit","setDialog","partners_","users_","project_master","sus","setSus","admins","setAdmins","users","setUsers","state","unique_string","proxy","loaded","setLoaded","selectedUsers","setSelectedUsers","fetch","then","res","json","resp","data","success","undefined","length","_sus","filter","user","account_role","_admins","userNotIn","credential_string","_users","setTimeout","dataSet","queue","u","addToQueue","removeFromQueue","clickTrigger","userExisted","indexOf","closeDialog","height","map"],"sources":["C:/Users/trongnhan/OneDrive/Máy tính/ClientServer/APP/src/cpn/client/projects/suprojects/adduser.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport UserCard from '../../users/userselectcard';\r\nimport ReadOnlyUserCard from '../../users/usercard';\r\n\r\nexport default ( props ) => {\r\n    const { submit, setDialog, partners_ , users_, project_master } = props;\r\n\r\n    const [ sus, setSus ] = useState([]);\r\n    const [ admins, setAdmins ] = useState([]);\r\n    const [ users, setUsers ] = useState([]);\r\n    const { unique_string, proxy } = useSelector( state => state );\r\n    const [ loaded, setLoaded ] = useState(false);\r\n\r\n    const [ selectedUsers, setSelectedUsers ] = useState([]);\r\n\r\n    useEffect( () => {\r\n\r\n        fetch(`${proxy}/api/${ unique_string}/user/getall`).then( res => res.json() )\r\n        .then( resp => {\r\n            const { data, success } = resp;\r\n\r\n            if( data != undefined && data.length > 0 ) {\r\n                const _sus = data.filter( user => user.account_role === \"su\" );\r\n                const _admins = data.filter( user => user.account_role === \"admin\" && userNotIn(user, partners_ ) && user.credential_string != project_master);\r\n                const _users = data.filter( user => user.account_role === \"user\"  && userNotIn(user, users_ ) && user.credential_string != project_master);\r\n\r\n                setSus( _sus ); setAdmins( _admins ); setUsers( _users );\r\n                setTimeout(() => {\r\n                    setLoaded(true)\r\n                }, 500)\r\n            }\r\n        })\r\n\r\n    }, [])\r\n\r\n\r\n    const userNotIn = ( user, dataSet ) => {\r\n        const queue = dataSet.filter( u  =>  u.credential_string === user.credential_string );\r\n        if( queue.length > 0 ){\r\n            return false;\r\n        }\r\n        else{\r\n            return true\r\n        }\r\n    }\r\n\r\n    const addToQueue = ( user ) => {\r\n        setSelectedUsers([...selectedUsers, user])\r\n    }\r\n\r\n    const removeFromQueue = (user) => {\r\n        const queue = selectedUsers.filter(u =>  u.credential_string != user.credential_string )\r\n        setSelectedUsers(queue);\r\n    }\r\n\r\n    const clickTrigger = ( user ) => {\r\n        const userExisted = selectedUsers.indexOf( user );\r\n        if( userExisted != -1 ){\r\n            removeFromQueue(user)\r\n        }else{\r\n            addToQueue(user);\r\n        }\r\n    }\r\n\r\n    const closeDialog = () => {\r\n        if( selectedUsers.length > 0 ){\r\n            submit( selectedUsers )\r\n        }\r\n        setDialog()\r\n    }\r\n\r\n    return(\r\n        <div className=\"fixed-default z-index-11 fullscreen p-1\">\r\n            <div className=\"rel z-index-2 container bg-white h-fit column\">\r\n                { !loaded ?\r\n                    <div className=\"w-100-pct h-fit flex flex-middle\">\r\n                        <img className=\"circle-processing\" src=\"/assets/image/circle-processing.png\"/>\r\n                    </div>\r\n                    :\r\n                    <div className=\"column w-100-pct h-fit p-0-5\">\r\n                        <div className=\"flex w-100-pct scroll-x horizon-scroll-bar border-1-dashed\" style={{ height: \"150px\" }}>\r\n                            { selectedUsers.length > 0 ?selectedUsers.map( user =>\r\n                                <UserCard user={ user } clickTrigger={ clickTrigger }  width={ 325 }/>\r\n                            ) :\r\n                                <span className=\"block w-100-pct text-center p-2\">Những người được chọn sẽ xuất hiện ở đây</span>\r\n                            }\r\n                        </div>\r\n                        <div className=\"users-box flex flex-no-wrap\">\r\n\r\n                          {/* ADMINS */}\r\n                            <div className=\"w-50-pct p-1 h-fit\">\r\n                                <div className=\"column h-fit\">\r\n                                    <div className=\"block shadow-blur p-1\">\r\n                                        <input placeholder=\"Quản trị viên\" spellCheck=\"false\" className=\"no-border block w-100-pct\"/>\r\n                                    </div>\r\n                                    <div className=\"h-fit scroll-y p-1\">\r\n                                        { admins.map( user =>\r\n                                            <UserCard user={ user } clickTrigger={ clickTrigger }/>\r\n                                        )}\r\n\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* USERS */}\r\n\r\n                            <div className=\"w-50-pct p-1 h-fit\">\r\n                                <div className=\"column h-fit\">\r\n                                    <div className=\"block shadow-blur p-1\">\r\n                                        <input placeholder=\"Người dùng\" spellCheck=\"false\" className=\"no-border block w-100-pct\"/>\r\n                                    </div>\r\n                                    <div className=\"h-fit scroll-y p-1\">\r\n                                        { users.map( user =>\r\n                                            <UserCard user={ user } clickTrigger={ clickTrigger }/>\r\n                                        )}\r\n\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n\r\n                        </div>\r\n                    </div>\r\n                }\r\n            </div>\r\n            <div className=\"abs-default z-index-1 fullscreen trans-dark\" onClick={ closeDialog }></div>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}