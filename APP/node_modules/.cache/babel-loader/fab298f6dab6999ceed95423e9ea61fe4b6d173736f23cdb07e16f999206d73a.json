{"ast":null,"code":"import _toConsumableArray from\"D:/Nhan/DIPE_V2/Client/DIPE/APP/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"D:/Nhan/DIPE_V2/Client/DIPE/APP/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/Nhan/DIPE_V2/Client/DIPE/APP/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import UserCard from'../../users/userselectcard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default(function(props){var submit=props.submit,formSwitching=props.formSwitching,project_master=props.project_master,projects=props.projects,setProjects=props.setProjects;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),admins=_useState2[0],setAdmins=_useState2[1];var _useSelector=useSelector(function(state){return state;}),unique_string=_useSelector.unique_string,proxy=_useSelector.proxy;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loaded=_useState4[0],setLoaded=_useState4[1];var _useState5=useState({project_name:\"Dự án mới\",description:\"Mô tả cho dự án mới.\"}),_useState6=_slicedToArray(_useState5,2),project=_useState6[0],setProject=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),currentPrivilege=_useState8[0],setCurrentPrivilege=_useState8[1];var defaultHeight=400;var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),height=_useState10[0],setHeight=_useState10[1];useEffect(function(){fetch(\"\".concat(proxy,\"/api/\").concat(unique_string,\"/user/getall\")).then(function(res){return res.json();}).then(function(resp){var data=resp.data,success=resp.success;if(data!=undefined&&data.length>0){var projectMaster=data.filter(function(user){return user.credential_string===project_master;})[0];var _admins=data.filter(function(user){return user.account_role===\"admin\";});setAdmins(_admins);setProject(_objectSpread(_objectSpread({},project),{},{project_master:projectMaster}));setCurrentPrivilege(projectMaster.account_role);setTimeout(function(){setLoaded(true);},500);}});},[]);var changeMaster=function changeMaster(){if(currentPrivilege===\"su\"){setHeight(height!=0?0:defaultHeight);}};var adminSelected=function adminSelected(user){setProject(_objectSpread(_objectSpread({},project),{},{project_master:user}));setHeight(0);};var submitProject=function submitProject(){fetch(\"\".concat(proxy,\"/api/\").concat(unique_string,\"/projects\"),{method:\"POST\",headers:{\"content-type\":\"application/json\"},body:JSON.stringify({project:project})}).then(function(res){return res.json();}).then(function(resp){var project=resp.project;setProjects([].concat(_toConsumableArray(projects),[project]));formSwitching();});};return/*#__PURE__*/_jsxs(\"div\",{className:\"fixed-default z-index-11 fullscreen p-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rel z-index-2 container bg-white h-fit column\",children:!loaded?/*#__PURE__*/_jsx(\"div\",{className:\"w-100-pct h-fit flex flex-middle\",children:/*#__PURE__*/_jsx(\"img\",{className:\"circle-processing\",src:\"/assets/image/circle-processing.png\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"column w-100-pct h-fit p-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-100-pct\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{spellCheck:\"false\",placeholder:\"T\\xEAn d\\u1EF1 \\xE1n\",className:\"block no-border border-1-bottom w-100-pct text-28-px p-1 text-center\",value:project.project_name,onChange:function onChange(e){setProject(_objectSpread(_objectSpread({},project),{},{project_name:e.target.value}));}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-no-wrap m-t-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-50-pct\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"block border-1-bottom w-100-pct text-16-pct size-fixed scroll-y no-border\",style:{height:\"200px\"},onChange:function onChange(e){setProject(_objectSpread(_objectSpread({},project),{},{description:e.target.value}));},placeholder:\"Mô tả dự án\",value:project.description})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-40-pct p-1 ml-auto border-1-bottom\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-16-px block\",children:\"Nh\\xE2n vi\\xEAn ph\\u1EE5 tr\\xE1ch\"}),/*#__PURE__*/_jsx(\"div\",{className:\"m-t-1\",children:project.project_master?/*#__PURE__*/_jsx(UserCard,{user:project.project_master,readOnly:true,clickTrigger:changeMaster}):null})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rel w-100-pct\",children:/*#__PURE__*/_jsx(\"div\",{className:\"abs w-40-pct r-0 t-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-100-pct shadow-blur ease no-overflow\",style:{height:\"\".concat(height,\"px\")},children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-100-pct column\",style:{height:\"\".concat(defaultHeight,\"px\")},children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-100-pct p-0-5\",children:/*#__PURE__*/_jsx(\"input\",{className:\"no-border text-16-px p-1 border-1-bottom block w-100-pct\",placeholder:\"Tìm kiếm\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"fill-available scroll-x\",children:admins.map(function(admin){return/*#__PURE__*/_jsx(UserCard,{user:admin,readOnly:\"true\",clickTrigger:adminSelected},admin.credential_string);})})]})})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"abs b-0 r-0 p-1\",children:/*#__PURE__*/_jsx(\"button\",{onClick:submitProject,className:\"upper pointer block w-max-content white text-center p-t-0-5 p-b-0-5 p-l-1 p-r-1 no-border bg-green\",children:\"Th\\xEAm\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"abs-default z-index-1 fullscreen trans-dark\",onClick:formSwitching})]});});","map":{"version":3,"names":["useState","useEffect","useDispatch","useSelector","UserCard","props","submit","formSwitching","project_master","projects","setProjects","admins","setAdmins","state","unique_string","proxy","loaded","setLoaded","project_name","description","project","setProject","currentPrivilege","setCurrentPrivilege","defaultHeight","height","setHeight","fetch","then","res","json","resp","data","success","undefined","length","projectMaster","filter","user","credential_string","_admins","account_role","setTimeout","changeMaster","adminSelected","submitProject","method","headers","body","JSON","stringify","e","target","value","map","admin"],"sources":["D:/Nhan/DIPE_V2/Client/DIPE/APP/src/cpn/client/projects/suprojects/addproject.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport UserCard from '../../users/userselectcard';\r\n\r\nexport default ( props ) => {\r\n    const { submit, formSwitching, project_master, projects, setProjects } = props;\r\n\r\n\r\n    const [ admins, setAdmins ] = useState([]);\r\n\r\n    const { unique_string, proxy } = useSelector( state => state );\r\n    const [ loaded, setLoaded ] = useState(false);\r\n    const [ project, setProject ] = useState({\r\n        project_name: \"Dự án mới\",\r\n        description: \"Mô tả cho dự án mới.\",\r\n    })\r\n    const [ currentPrivilege, setCurrentPrivilege ] = useState(\"\");\r\n    const defaultHeight = 400;\r\n    const [ height, setHeight ] = useState(0);\r\n\r\n    useEffect( () => {\r\n\r\n        fetch(`${proxy}/api/${ unique_string}/user/getall`).then( res => res.json() )\r\n        .then( resp => {\r\n            const { data, success } = resp;\r\n\r\n            if( data != undefined && data.length > 0 ) {\r\n                const projectMaster = data.filter( user => user.credential_string === project_master )[0];\r\n                const _admins = data.filter( user => user.account_role === \"admin\" );\r\n                setAdmins( _admins );\r\n                setProject({ ...project, project_master: projectMaster })\r\n                setCurrentPrivilege( projectMaster.account_role )\r\n                setTimeout(() => {\r\n                    setLoaded(true)\r\n                }, 500)\r\n            }\r\n        })\r\n\r\n    }, [])\r\n\r\n    const changeMaster = () => {\r\n        if( currentPrivilege === \"su\" ){\r\n\r\n            setHeight( height != 0 ? 0: defaultHeight )\r\n\r\n        }\r\n    }\r\n\r\n    const adminSelected = ( user ) => {\r\n        setProject({ ...project, project_master: user })\r\n        setHeight( 0 )\r\n    }\r\n\r\n    const submitProject = () => {\r\n        fetch(`${ proxy }/api/${ unique_string }/projects`, {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"content-type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ project })\r\n        }).then( res => res.json() ).then( resp => {\r\n            const { project } = resp\r\n            setProjects([...projects, project])\r\n            formSwitching()\r\n        })\r\n    }\r\n\r\n    return(\r\n        <div className=\"fixed-default z-index-11 fullscreen p-1\">\r\n            <div className=\"rel z-index-2 container bg-white h-fit column\">\r\n                { !loaded ?\r\n                    <div className=\"w-100-pct h-fit flex flex-middle\">\r\n                        <img className=\"circle-processing\" src=\"/assets/image/circle-processing.png\"/>\r\n                    </div>\r\n                    :\r\n                    <div className=\"column w-100-pct h-fit p-1\">\r\n                        <div className=\"w-100-pct\">\r\n                            <div>\r\n                                <input spellCheck=\"false\" placeholder=\"Tên dự án\" className=\"block no-border border-1-bottom w-100-pct text-28-px p-1 text-center\" value={ project.project_name }\r\n                                    onChange={ (e) => {\r\n                                        setProject( {...project, project_name: e.target.value} )\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex flex-no-wrap m-t-2\">\r\n                                <div className=\"w-50-pct\">\r\n                                    <textarea className=\"block border-1-bottom w-100-pct text-16-pct size-fixed scroll-y no-border\" style={{ height: \"200px\" }}\r\n                                        onChange={ (e) => {\r\n                                            setProject( {...project, description: e.target.value} )\r\n                                        }}\r\n                                        placeholder={ \"Mô tả dự án\" }\r\n                                        value={ project.description }\r\n                                    />\r\n                                </div>\r\n                                <div className=\"w-40-pct p-1 ml-auto border-1-bottom\">\r\n                                    <span className=\"text-16-px block\">Nhân viên phụ trách</span>\r\n                                    <div className=\"m-t-1\">\r\n                                        { project.project_master ?\r\n                                            <UserCard user={ project.project_master } readOnly={ true } clickTrigger={ changeMaster }/>\r\n                                         : null}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"rel w-100-pct\">\r\n                                <div className=\"abs w-40-pct r-0 t-0\">\r\n                                    <div className=\"w-100-pct shadow-blur ease no-overflow\" style={{ height: `${ height }px` }}>\r\n                                        <div className=\"w-100-pct column\" style={{ height: `${ defaultHeight }px` }}>\r\n                                            <div className=\"w-100-pct p-0-5\">\r\n                                                <input className=\"no-border text-16-px p-1 border-1-bottom block w-100-pct\" placeholder={\"Tìm kiếm\"}/>\r\n                                            </div>\r\n                                            <div className=\"fill-available scroll-x\">\r\n                                                { admins.map( admin =>\r\n                                                    <UserCard user={ admin } key={ admin.credential_string } readOnly=\"true\"\r\n                                                        clickTrigger={ adminSelected }\r\n                                                    />\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                        <div className=\"abs b-0 r-0 p-1\">\r\n                            <button onClick={ submitProject } className=\"upper pointer block w-max-content white text-center p-t-0-5 p-b-0-5 p-l-1 p-r-1 no-border bg-green\">Thêm</button>\r\n                        </div>\r\n\r\n                    </div>\r\n                }\r\n            </div>\r\n            <div className=\"abs-default z-index-1 fullscreen trans-dark\" onClick={ formSwitching }></div>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}